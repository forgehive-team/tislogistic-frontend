import{a as f,e as b,b as D,u as I}from"./entry.f68164cd.js";import{m as n,F as o,H as s,R as p,I as r,Q as g,y as _,x as y,J as N,L as C,N as m,T as w,U as S,V as k}from"./swiper-vue.2993ddf4.js";import{_ as x}from"./expand.901515da.js";import{_ as $}from"./nuxt-link.93954f67.js";import{u as F,c as M}from"./state.ba484c07.js";import{v as O}from"./validate.40c86f85.js";const U={props:{formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0}},emits:["fieldUpd"],data(){return{cityOptionsShown:!1}},computed:{cities(){const t=b();return["services-terminalnie-uslugi","services-terminal-services"].includes(t.name)?{20:"Vladivostok",30:"Novosibirsk",70:"Khabarovsk"}:{2:"Vladivostok",3:"Novosibirsk",4:"Moscow",5:"Saint Petersburg",6:"Nakhodka",7:"Khabarovsk",8:"Ussuriysk"}},citiesIDs(){return Object.keys(this.cities)},cityChosen(){const{$texts:t}=D();return this.formData.city_id?this.cities[this.formData.city_id]:t.chooseClosestBranch}},methods:{updateField(t){this.$emit("fieldUpd",t)}}},q=t=>(S("data-v-df70b09f"),t=t(),k(),t),j={key:0,class:"calculator__options"},B=["onClick"],V=q(()=>s("label",{class:"calculator__input-label"},"Branch",-1)),L={key:0,class:"calculator__error-message"};function P(t,a,e,d,l,i){return n(),o("div",{class:"calculator__input-container select_container",onClick:a[0]||(a[0]=c=>l.cityOptionsShown=!l.cityOptionsShown)},[s("div",{class:g(["calculator__select",{gray:!e.formData.city_id}])},[p(r(i.cityChosen)+" ",1),s("img",{src:x,class:g({rotated:l.cityOptionsShown}),alt:""},null,2),_(w,null,{default:y(()=>[l.cityOptionsShown?(n(),o("ul",j,[(n(!0),o(N,null,C(i.citiesIDs,(c,h)=>(n(),o("li",{key:h,onClick:v=>i.updateField(c,"city_id")},r(i.cities[c]),9,B))),128))])):m("",!0)]),_:1})],2),V,e.invalidInputMessages.city_id?(n(),o("div",L,r(e.invalidInputMessages.city_id),1)):m("",!0)])}const T=f(U,[["render",P],["__scopeId","data-v-df70b09f"]]),E=""+new URL("info.ab8754de.svg",import.meta.url).href;const R={props:{formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0},inputName:{type:String,required:!0}},emits:["fieldUpd"],methods:{updateField(t){const a=t.target.value;this.$emit("fieldUpd",a)}}},J={class:"calculator__input-container"},K=["alt"],z={key:1,class:"calculator__description-message"},A=["placeholder","value"],H=["type","placeholder","value"],Q={class:"calculator__input-label"},G={key:4,class:"calculator__error-message"};function W(t,a,e,d,l,i){return n(),o("div",J,[e.inputName==="description"?(n(),o("img",{key:0,src:E,class:"calculator__info_icon",alt:t.$texts.additionalInfo},null,8,K)):m("",!0),e.inputName==="description"?(n(),o("div",z,r(t.$texts.descriptionInputMessage),1)):m("",!0),e.inputName==="phone"?(n(),o("input",{key:2,class:"calculator__input",placeholder:t.$texts[e.inputName],value:e.formData[e.inputName],onInput:a[0]||(a[0]=(...c)=>i.updateField&&i.updateField(...c))},null,40,A)):(n(),o("input",{key:3,type:e.inputName==="email"?"email":"text",class:"calculator__input",placeholder:t.$texts[e.inputName],value:e.formData[e.inputName],onInput:a[1]||(a[1]=(...c)=>i.updateField&&i.updateField(...c))},null,40,H)),s("label",Q,r(t.$texts[e.inputName]),1),e.invalidInputMessages[e.inputName]?(n(),o("div",G,r(e.invalidInputMessages[e.inputName]),1)):m("",!0)])}const X=f(R,[["render",W],["__scopeId","data-v-747640bf"]]);const Y={props:{handleSubmit:{type:Function,required:!0},formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0}},emits:["fieldUpd"]},Z=t=>(S("data-v-c036e5e5"),t=t(),k(),t),tt={class:"calculator__body"},et={class:"calculator__second-desktop-layout-container"},at={class:"calculator__email-container"},st={class:"calculator__email-note"},it={class:"calculator__bottom"},nt={class:"calculator__send-container"},ot={class:"calculator__confidentiality"},lt=Z(()=>s("span",null,'"Send"',-1));function ct(t,a,e,d,l,i){const c=T,h=X,v=$;return n(),o("div",tt,[s("div",et,[_(c,{"form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,onFieldUpd:a[0]||(a[0]=u=>t.$emit("fieldUpd",u,"city_id"))},null,8,["form-data","invalid-input-messages"]),_(h,{class:"shrink","form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,"input-name":"phone",onFieldUpd:a[1]||(a[1]=u=>t.$emit("fieldUpd",u,"phone"))},null,8,["form-data","invalid-input-messages"]),s("div",at,[_(h,{class:"shrink","form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,"input-name":"email",onFieldUpd:a[2]||(a[2]=u=>t.$emit("fieldUpd",u,"email"))},null,8,["form-data","invalid-input-messages"]),s("p",st,r(t.$texts.calculatorEmailNote),1)])]),s("div",it,[s("div",nt,[s("button",{class:"calculator__button animate-red",onClick:a[3]||(a[3]=(...u)=>e.handleSubmit&&e.handleSubmit(...u))},r(t.$texts.send),1),s("div",ot,[p(" By clicking "),lt,p(", you accept the terms of "),_(v,{to:"/eula",target:"_blank"},{default:y(()=>[p("user agreement ")]),_:1}),p("and "),_(v,{to:"/privacy-policy",target:"_blank"},{default:y(()=>[p("privacy policy")]),_:1})])])])])}const rt=f(Y,[["render",ct],["__scopeId","data-v-c036e5e5"]]);const dt={setup(){const t=F(),a=M(),e=b();return{calculatorPopupShown:t,successShown:a,route:e}},data(){return{firstStep:!1,formData:{city_id:"",phone:"",email:""},invalidInputMessages:{city_id:"",phone:"",email:""},unwatchers:{phone:null,email:null}}},methods:{clearError(t,a){this.invalidInputMessages[t]="",a()},updateField(t,a){this.formData[a]=t},handleSubmit(){let t=!0;for(const[a,e]of Object.entries(this.formData)){const d=O(e,a);if(d){this.invalidInputMessages[a]=d,t=!1;const l=this.$watch(()=>this.formData[a],()=>this.clearError(a,l))}}t&&(this.isFirstStep?this.goSecondStep():this.sendData())},async sendData(){const{apiBase:t}=I();this.successShown=!this.successShown,this.calculatorPopupShown=!1;const a=Object.keys(this.route.query).length?this.route.query:null,e={...this.formData,query_params:a};try{dataLayer&&dataLayer.push({event:"calc_delivery"}),await $fetch(`${t}/api/calculation_request/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"}),this.clearData()}catch{this.clearData()}},clearData(){for(const t in this.formData)this.formData[t]=""}}},ut={id:"calculator",class:"calculator"},_t={class:"calculator__title"},pt={class:"calculator__subtitle"};function mt(t,a,e,d,l,i){const c=rt;return n(),o("div",ut,[s("h2",_t,r(t.$texts.calculateTitle),1),s("p",pt,r(t.$texts.legalEntitiesOnly),1),_(c,{"handle-submit":i.handleSubmit,"form-data":l.formData,"invalid-input-messages":l.invalidInputMessages,onFieldUpd:i.updateField},null,8,["handle-submit","form-data","invalid-input-messages","onFieldUpd"])])}const St=f(dt,[["render",mt],["__scopeId","data-v-7364d8b6"]]);export{St as _};
