import{a as f,e as D,b as I,u as N}from"./entry.8f66b6e8.js";import{m as n,F as l,H as i,R as p,I as r,Q as b,y as m,x as y,J as C,L as w,N as h,T as x,U as S,V as k,aa as F,a5 as $}from"./swiper-vue.cf596ed4.js";import{U as g}from"./maska.b0acde3f.js";import{_ as M}from"./expand.c2d6f9f3.js";import{_ as O}from"./nuxt-link.eea73dbd.js";import{u as U,c as q}from"./state.d59fa9d4.js";import{v as j}from"./validate.359f59e0.js";const T={directives:{maska:g},props:{formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0}},emits:["fieldUpd"],data(){return{cityOptionsShown:!1}},computed:{cities(){const t=D();return["services-terminalnie-uslugi","services-terminal-services"].includes(t.name)?{20:"Владивосток",30:"Новосибирск",70:"Хабаровск"}:{2:"Владивосток",3:"Новосибирск",4:"Москва",5:"Санкт-Петербург",6:"Находка",7:"Хабаровск",8:"Уссурийск"}},citiesIDs(){return Object.keys(this.cities)},cityChosen(){const{$texts:t}=I();return this.formData.city_id?this.cities[this.formData.city_id]:t.chooseClosestBranch}},methods:{updateField(t){this.$emit("fieldUpd",t)}}},B=t=>(S("data-v-964a3069"),t=t(),k(),t),L={key:0,class:"calculator__options"},E=["onClick"],P=B(()=>i("label",{class:"calculator__input-label"},"Филиал",-1)),V={key:0,class:"calculator__error-message"};function R(t,a,e,u,o,s){return n(),l("div",{class:"calculator__input-container select_container",onClick:a[0]||(a[0]=d=>o.cityOptionsShown=!o.cityOptionsShown)},[i("div",{class:b(["calculator__select",{gray:!e.formData.city_id}])},[p(r(s.cityChosen)+" ",1),i("img",{src:M,class:b({rotated:o.cityOptionsShown}),alt:""},null,2),m(x,null,{default:y(()=>[o.cityOptionsShown?(n(),l("ul",L,[(n(!0),l(C,null,w(s.citiesIDs,(d,c)=>(n(),l("li",{key:c,onClick:v=>s.updateField(d,"city_id")},r(s.cities[d]),9,E))),128))])):h("",!0)]),_:1})],2),P,e.invalidInputMessages.city_id?(n(),l("div",V,r(e.invalidInputMessages.city_id),1)):h("",!0)])}const J=f(T,[["render",R],["__scopeId","data-v-964a3069"]]),z=""+new URL("info.ab8754de.svg",import.meta.url).href;const A={directives:{maska:g},props:{formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0},inputName:{type:String,required:!0}},emits:["fieldUpd"],methods:{updateField(t){const a=t.target.value;this.$emit("fieldUpd",a)},setNumberToDefault(){this.formData.phone||this.$emit("fieldUpd","+7")}}},H={class:"calculator__input-container"},Q=["alt"],G={key:1,class:"calculator__description-message"},K=["placeholder","value"],W=["type","placeholder","value"],X={class:"calculator__input-label"},Y={key:4,class:"calculator__error-message"};function Z(t,a,e,u,o,s){const d=F("maska");return n(),l("div",H,[e.inputName==="description"?(n(),l("img",{key:0,src:z,class:"calculator__info_icon",alt:t.$texts.additionalInfo},null,8,Q)):h("",!0),e.inputName==="description"?(n(),l("div",G,r(t.$texts.descriptionInputMessage),1)):h("",!0),e.inputName==="phone"?$((n(),l("input",{key:2,"data-maska":"+# ### ###-##-##",class:"calculator__input",placeholder:t.$texts[e.inputName],value:e.formData[e.inputName],onInput:a[0]||(a[0]=(...c)=>s.updateField&&s.updateField(...c)),onClick:a[1]||(a[1]=(...c)=>s.setNumberToDefault&&s.setNumberToDefault(...c))},null,40,K)),[[d]]):(n(),l("input",{key:3,type:e.inputName==="email"?"email":"text",class:"calculator__input",placeholder:t.$texts[e.inputName],value:e.formData[e.inputName],onInput:a[2]||(a[2]=(...c)=>s.updateField&&s.updateField(...c))},null,40,W)),i("label",X,r(t.$texts[e.inputName]),1),e.invalidInputMessages[e.inputName]?(n(),l("div",Y,r(e.invalidInputMessages[e.inputName]),1)):h("",!0)])}const tt=f(A,[["render",Z],["__scopeId","data-v-211b6d59"]]);const et={directives:{maska:g},props:{handleSubmit:{type:Function,required:!0},formData:{type:Object,required:!0},invalidInputMessages:{type:Object,required:!0}},emits:["fieldUpd"]},at=t=>(S("data-v-25fd4c89"),t=t(),k(),t),st={class:"calculator__body"},it={class:"calculator__second-desktop-layout-container"},nt={class:"calculator__email-container"},lt={class:"calculator__email-note"},ot={class:"calculator__bottom"},ct={class:"calculator__send-container"},rt={class:"calculator__confidentiality"},dt=at(()=>i("span",null,"«Отправить»",-1));function ut(t,a,e,u,o,s){const d=J,c=tt,v=O;return n(),l("div",st,[i("div",it,[m(d,{"form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,onFieldUpd:a[0]||(a[0]=_=>t.$emit("fieldUpd",_,"city_id"))},null,8,["form-data","invalid-input-messages"]),m(c,{class:"shrink","form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,"input-name":"phone",onFieldUpd:a[1]||(a[1]=_=>t.$emit("fieldUpd",_,"phone"))},null,8,["form-data","invalid-input-messages"]),i("div",nt,[m(c,{class:"shrink","form-data":e.formData,"invalid-input-messages":e.invalidInputMessages,"input-name":"email",onFieldUpd:a[2]||(a[2]=_=>t.$emit("fieldUpd",_,"email"))},null,8,["form-data","invalid-input-messages"]),i("p",lt,r(t.$texts.calculatorEmailNote),1)])]),i("div",ot,[i("div",ct,[i("button",{class:"calculator__button animate-red",onClick:a[3]||(a[3]=(..._)=>e.handleSubmit&&e.handleSubmit(..._))},r(t.$texts.send),1),i("div",rt,[p(" Нажимая кнопку "),dt,p(", Вы принимаете условия "),m(v,{to:"/eula",target:"_blank"},{default:y(()=>[p("пользовательского соглашения ")]),_:1}),p("и "),m(v,{to:"/politika-konfidencialnosti",target:"_blank"},{default:y(()=>[p("политики конфиденциальности")]),_:1})])])])])}const _t=f(et,[["render",ut],["__scopeId","data-v-25fd4c89"]]);const mt={setup(){const t=U(),a=q(),e=D();return{calculatorPopupShown:t,successShown:a,route:e}},data(){return{firstStep:!1,formData:{city_id:"",phone:"",email:""},invalidInputMessages:{city_id:"",phone:"",email:""},unwatchers:{phone:null,email:null}}},methods:{clearError(t,a){this.invalidInputMessages[t]="",a()},updateField(t,a){this.formData[a]=t},handleSubmit(){let t=!0;for(const[a,e]of Object.entries(this.formData)){const u=j(e,a);if(u){this.invalidInputMessages[a]=u,t=!1;const o=this.$watch(()=>this.formData[a],()=>this.clearError(a,o))}}t&&(this.isFirstStep?this.goSecondStep():this.sendData())},async sendData(){const{apiBase:t}=N();this.successShown=!this.successShown,this.calculatorPopupShown=!1;const a=Object.keys(this.route.query).length?this.route.query:null,e={...this.formData,query_params:a};try{dataLayer&&dataLayer.push({event:"calc_delivery"}),await $fetch(`${t}/api/calculation_request/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"}),this.clearData()}catch{this.clearData()}},clearData(){for(const t in this.formData)this.formData[t]=""}}},pt={id:"calculator",class:"calculator"},ht={class:"calculator__title"},ft={class:"calculator__subtitle"};function vt(t,a,e,u,o,s){const d=_t;return n(),l("div",pt,[i("h2",ht,r(t.$texts.calculateTitle),1),i("p",ft,r(t.$texts.legalEntitiesOnly),1),m(d,{"handle-submit":s.handleSubmit,"form-data":o.formData,"invalid-input-messages":o.invalidInputMessages,onFieldUpd:s.updateField},null,8,["handle-submit","form-data","invalid-input-messages","onFieldUpd"])])}const Nt=f(mt,[["render",vt],["__scopeId","data-v-7364d8b6"]]);export{Nt as _};
